<!DOCTYPE html>
<html lang=" en-US ">

<head>
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/assets/css/style.css?v=78c8719698feee0553096165409216db0a43f06f">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">

	<style>
		.navbar {
			overflow: hidden;
		}

		.navbar a {
			float: left;
			font-size: 16px;
			color: white;
			padding: 2px 15px;
			text-align: center;
			text-decoration: none;
		}

		.dropdown {
			float: left;
			overflow: hidden;
		}

		.dropdown .dropbtn {
			font-size: 16px;
			border: none;
			outline: none;
			color: white;
			padding: 2px 15px;
			background-color: inherit;
			font-family: inherit;
			margin: 0;
		}

		.navbar a:hover,
		.dropdown:hover .dropbtn {
			background-color: green;
		}

		.dropdown-content {
			display: none;
			position: absolute;
			background-color: #202020;
			min-width: 150px;
			box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
			z-index: 1;
		}

		.dropdown-content a {
			float: none;
			color: white;
			padding: 8px 14px;
			text-decoration: none;
			display: block;
			text-align: left;
		}

		.dropdown-content a:hover {
			background-color: #4666FF;
		}

		.dropdown:hover .dropdown-content {
			display: block;
		}
	</style>

	<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>datdhruvjain.github.io | Interesting learnings on Computer stuff.</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="datdhruvjain.github.io" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Interesting learnings on Computer stuff." />
<meta property="og:description" content="Interesting learnings on Computer stuff." />
<link rel="canonical" href="http://192.168.1.117:4000/prog_langs/python/Data-Science/Machine-Learning-E2EE.html" />
<meta property="og:url" content="http://192.168.1.117:4000/prog_langs/python/Data-Science/Machine-Learning-E2EE.html" />
<meta property="og:site_name" content="datdhruvjain.github.io" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="datdhruvjain.github.io" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://192.168.1.117:4000/prog_langs/python/Data-Science/Machine-Learning-E2EE.html","headline":"datdhruvjain.github.io","description":"Interesting learnings on Computer stuff.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

	<header>
		<div class="container">
			<a id="a-title" href="/">
				<h1>datdhruvjain.github.io</h1>
			</a>
			<h2>Interesting learnings on Computer stuff.</h2>

			<!--- need to check what this is all about
		<section id="downloads">
		
		</section>
		--->

			<section class="navbar">


				<!-- THE NON-DROPDOWN MENUS WORK LIKE THIS
				----------------------------------------
				
				<a href="https://datdhruvjain.github.io/directory/file">Title 1</a>
				<a href="./relative-file">Title 2</a>
				<a href="../dir/relative-file-path">Title 3</a>
				<a href="https://datdhruvjain.github.io/blockchain/blockchain">Blockchain</a>

				#	Do Not add add the extention to the file, eg do not put file.md, just file
				---------------------------------------->

				<!-- THE DROPDOWN MENUS WORK LIKE THIS
				----------------------------------------
				
				<div class="dropdown">
					<button class="dropbtn">dropdown-title
						<i class="fa fa-caret-down"></i>
					</button>
					<div class="dropdown-content">
						<a href="https://datdhruvjain.github.io/directory/file">Title 1</a>
						<a href="./relative-file">Title 2</a>
						<a href="../dir/relative-file-path">Title 3</a>
					</div>
				</div>

				#	Do Not add add the extention to the file, eg do not put file.md, just file
				------------------------------------------>

				<a href="/configurations/configurations">My Configs</a>


				<div class="dropdown">
					<button class="dropbtn">Journeys
						<i class="fa fa-caret-down"></i>
					</button>
					<div class="dropdown-content">
						<!--a href="https://datdhruvjain.github.io/journeys/blockchain/blockchain">Blockchain</a-->
						<a href="/journeys/cybersec/cybersec">Cyber Sec</a>
						<a href="/journeys/thm/thm">TryHackMe Journeys</a>
					</div>
				</div>

				<div class="dropdown">
					<button class="dropbtn">Prog Langs
						<i class="fa fa-caret-down"></i>
					</button>
					<div class="dropdown-content">
						<a href="/prog_langs/python/python">Python</a>
						<a href="/prog_langs/cpp/cpp">C++</a>
					</div>
				</div>

				<div class="dropdown">
					<button class="dropbtn">Tools
						<i class="fa fa-caret-down"></i>
					</button>
					<div class="dropdown-content">
						<a href="/tools/git">Git</a>
						<a href="/tools/vim/vim-learnings">Vim</a>
						<a href="/tools/markdown">Markdown</a>
						<a href="/tools/computer-networks/computer-networks">Computer-Networks</a>
					</div>
				</div>


				<!-- add new items from here -->
			</section>

		</div>
	</header>

	<div class="container">
		<section id="main_content">
			<p>Well Well Well kiddo, you want to learn and build machine learning models, well you have come to the right place. We will go through a complete end to end machine learing process.</p>

<h2 id="getting-and-exploring-the-data">Getting and exploring the data</h2>

<p>you will need a method to get and update the datasets. this is because the data is dynamic and not static, It will keep evolving. how you do that is upto you and not really a part of machine learning.</p>

<p>After you have sorted out the abovee test, you will load the dataset via <code class="language-plaintext highlighter-rouge">pandas</code></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="c1"># read csv and create data object of type numpy
# need not be a csv, can be other file extentions too
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_frame_path</span><span class="p">)</span>
</code></pre></div></div>

<p>next you will want to explore the data.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_set</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">data_set</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">data_set</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">data_set</span><span class="p">.[</span><span class="s">"Feature"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>
<p>will be your friends here</p>

<h4 id="looking-for-correlation">looking for correlation</h4>
<p>simple way:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">housing</span> <span class="p">.</span> <span class="n">corr</span> <span class="p">()</span>
<span class="n">corr_matrix</span><span class="p">[</span><span class="s">"median_house_value"</span><span class="p">].</span><span class="n">sort_values</span> <span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>
<p>Another way to check for correlation between attributes is to use the pandas scatter_matrix() function, which plots every numerical attribute against every other numerical attribute. Since there are now 11 numerical attributes, you would get 11^2 = 121 plots, which would not fit on a page—so let’s just focus on a few promising attributes that seem most correlated with the median housing value</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">scatter_matrix</span>
<span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span> <span class="s">"median_house_value"</span> <span class="p">,</span> <span class="s">"median_income"</span> <span class="p">,</span> <span class="s">"total_rooms"</span> <span class="p">,</span> <span class="s">"housing_median_age"</span> <span class="p">]</span>
<span class="n">scatter_matrix</span> <span class="p">(</span> <span class="n">housing</span> <span class="p">[</span> <span class="n">attributes</span> <span class="p">],</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">12</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">))</span>
</code></pre></div></div>
<h4 id="experimenting-with-attribute-combinations">Experimenting with Attribute Combinations</h4>
<p>By mixing and matching the attributes, you can have good correlation between the result and the mixed-matched attribute</p>

<h2 id="segregating-the-data-into-test-set-and-train-set">Segregating the data into test set and train set</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_set</span> <span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">train_test_split</span> <span class="p">(</span> <span class="n">housing</span> <span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span> <span class="p">)</span>
<span class="c1"># two variables, train_set and test_set get asigned numpy arrays
# the first argument specifies the data-set,
# the second argument specifies the ratio of spliting
# the third argument specifies the random generator seed, which specifies which elements get picked
</span></code></pre></div></div>

<h4 id="stratified-datasets">Stratified datasets</h4>

<p>random spliting if data may <em>not</em> be a good indicator of the actual dataset, so to have a dataset that is representative of the actual dataset, we use straatified shuffling</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedShuffleSplit</span>
<span class="n">split</span> <span class="o">=</span> <span class="n">StratifiedShuffleSplit</span> <span class="p">(</span> <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span> <span class="p">)</span> <span class="k">for</span> <span class="n">train_index</span> <span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">split</span> <span class="p">.</span> <span class="n">split</span> <span class="p">(</span> <span class="n">housing</span> <span class="p">,</span> <span class="n">housing</span> <span class="p">[</span> <span class="s">"income_cat"</span> <span class="p">]):</span> <span class="n">strat_train_set</span> <span class="o">=</span> <span class="n">housing</span> <span class="p">.</span> <span class="n">loc</span> <span class="p">[</span> <span class="n">train_index</span> <span class="p">]</span> <span class="n">strat_test_set</span> <span class="o">=</span> <span class="n">housing</span> <span class="p">.</span> <span class="n">loc</span> <span class="p">[</span> <span class="n">test_index</span> <span class="p">]</span>
</code></pre></div></div>

<h2 id="dealing-with-missing-data">Dealing with missing data</h2>
<ol>
  <li>You can drop the data columns that contain missing data
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">housing</span><span class="p">.</span><span class="n">dropna</span> <span class="p">(</span> <span class="n">subset</span> <span class="o">=</span> <span class="p">[</span> <span class="s">"total_bedrooms"</span> <span class="p">])</span> <span class="c1"># option 1 
</span><span class="n">housing</span><span class="p">.</span><span class="n">drop</span> <span class="p">(</span> <span class="s">"total_bedrooms"</span> <span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span> <span class="c1"># option 2 
</span></code></pre></div>    </div>
  </li>
  <li>fill the missing places with median values
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">median</span> <span class="o">=</span> <span class="n">housing</span> <span class="p">[</span> <span class="s">"total_bedrooms"</span> <span class="p">]</span> <span class="p">.</span> <span class="n">median</span> <span class="p">()</span> <span class="c1"># option 3 
</span> <span class="n">housing</span> <span class="p">[</span> <span class="s">"total_bedrooms"</span> <span class="p">]</span> <span class="p">.</span> <span class="n">fillna</span> <span class="p">(</span> <span class="n">median</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span> <span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>Use an imputer
imputer will fill all missing values based on the <code class="language-plaintext highlighter-rouge">statergy</code> this is specified
<strong>However</strong>, imputation can only be done on numerical values!, you will have to drop text-based tables from the dataset while imputing. then join these data tables again.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span> <span class="p">(</span> <span class="n">strategy</span> <span class="o">=</span> <span class="s">"median"</span> <span class="p">)</span>
<span class="n">imputer</span><span class="p">.</span><span class="n">fit</span> <span class="p">(</span> <span class="n">housing_num</span> <span class="p">)</span>
<span class="n">imputer</span><span class="p">.</span><span class="n">fit</span> <span class="p">(</span> <span class="n">housing_num</span> <span class="p">)</span>
</code></pre></div>    </div>
    <p>The imputer has simply computed the median of each attribute and stored the result in its statistics_ instance variable. Only the total_bedrooms attribute had missing values, but we cannot be sure that there won’t be any missing values in new data after the system goes live, so it is safer to apply the imputer to all the numerical attributes:</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; imputer . statistics_ 
array([ -118.51 , 34.26 , 29. , 2119.5 , 433. , 1164. , 408. , 3.5409])
&gt;&gt;&gt; housing_num . median () . values
array([ -118.51 , 34.26 , 29. , 2119.5 , 433. , 1164. , 408. , 3.5409])
</code></pre></div>    </div>
  </li>
</ol>

		</section>
	</div>
</body>

</html>